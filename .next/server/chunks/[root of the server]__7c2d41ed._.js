module.exports = {

"[project]/.next-internal/server/app/api/analyze-website/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route.runtime.dev.js [external] (next/dist/compiled/next-server/app-route.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page.runtime.dev.js [external] (next/dist/compiled/next-server/app-page.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/puppeteer-core [external] (puppeteer-core, esm_import)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname, a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
const mod = await __turbopack_context__.y("puppeteer-core");

__turbopack_context__.n(mod);
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, true);}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/node:fs [external] (node:fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:fs", () => require("node:fs"));

module.exports = mod;
}}),
"[externals]/node:os [external] (node:os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:os", () => require("node:os"));

module.exports = mod;
}}),
"[externals]/node:path [external] (node:path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:path", () => require("node:path"));

module.exports = mod;
}}),
"[externals]/node:url [external] (node:url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:url", () => require("node:url"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/assert [external] (assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}}),
"[externals]/tty [external] (tty, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/events [external] (events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}}),
"[externals]/node:zlib [external] (node:zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:zlib", () => require("node:zlib"));

module.exports = mod;
}}),
"[project]/src/utils/screenshot.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname, a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
__turbopack_context__.s({
    "captureElementScreenshot": (()=>captureElementScreenshot),
    "captureWebsiteScreenshot": (()=>captureWebsiteScreenshot),
    "getPageMetadata": (()=>getPageMetadata)
});
var __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/puppeteer-core [external] (puppeteer-core, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/fs [external] (fs, cjs)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/path [external] (path, cjs)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@sparticuz/chromium-min/build/esm/index.js [app-route] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__
]);
([__TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__);
;
;
;
;
async function captureWebsiteScreenshot(url, outputDir = 'public/screenshots') {
    const browser = await __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__["default"].launch({
        args: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].args,
        executablePath: await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].executablePath(),
        headless: true
    });
    try {
        // Ensure output directory exists
        if (!__TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].existsSync(outputDir)) {
            __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].mkdirSync(outputDir, {
                recursive: true
            });
        }
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const desktopFilename = `desktop-${timestamp}.png`;
        const mobileFilename = `mobile-${timestamp}.png`;
        const desktopPath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(outputDir, desktopFilename);
        const mobilePath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(outputDir, mobileFilename);
        // Capture desktop screenshot
        const desktopPage = await browser.newPage();
        await desktopPage.setViewport({
            width: 1920,
            height: 1080
        });
        try {
            await desktopPage.goto(url, {
                waitUntil: 'networkidle2',
                timeout: 30000
            });
            await desktopPage.screenshot({
                path: desktopPath,
                fullPage: true
            });
        } catch (error) {
            console.warn('Desktop screenshot failed:', error);
            throw error;
        } finally{
            await desktopPage.close();
        }
        // Capture mobile screenshot
        const mobilePage = await browser.newPage();
        await mobilePage.setViewport({
            width: 375,
            height: 667
        });
        try {
            await mobilePage.goto(url, {
                waitUntil: 'networkidle2',
                timeout: 30000
            });
            await mobilePage.screenshot({
                path: mobilePath,
                fullPage: true
            });
        } catch (error) {
            console.warn('Mobile screenshot failed:', error);
            throw error;
        } finally{
            await mobilePage.close();
        }
        return {
            desktop: `/screenshots/${desktopFilename}`,
            mobile: `/screenshots/${mobileFilename}`
        };
    } finally{
        await browser.close();
    }
}
async function captureElementScreenshot(url, selector, outputDir = 'public/screenshots') {
    const browser = await __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__["default"].launch({
        args: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].args,
        executablePath: await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].executablePath(),
        headless: true
    });
    try {
        if (!__TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].existsSync(outputDir)) {
            __TURBOPACK__imported__module__$5b$externals$5d2f$fs__$5b$external$5d$__$28$fs$2c$__cjs$29$__["default"].mkdirSync(outputDir, {
                recursive: true
            });
        }
        const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
        const filename = `element-${timestamp}.png`;
        const filepath = __TURBOPACK__imported__module__$5b$externals$5d2f$path__$5b$external$5d$__$28$path$2c$__cjs$29$__["default"].join(outputDir, filename);
        const page = await browser.newPage();
        await page.setViewport({
            width: 1920,
            height: 1080
        });
        await page.goto(url, {
            waitUntil: 'networkidle2',
            timeout: 30000
        });
        // Wait for the element to be present
        await page.waitForSelector(selector, {
            timeout: 10000
        });
        // Take screenshot of specific element
        const element = await page.$(selector);
        if (element) {
            await element.screenshot({
                path: filepath
            });
        }
        await page.close();
        return `/screenshots/${filename}`;
    } finally{
        await browser.close();
    }
}
async function getPageMetadata(url) {
    const browser = await __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__["default"].launch({
        args: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].args,
        executablePath: await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].executablePath(),
        headless: true
    });
    try {
        const page = await browser.newPage();
        try {
            // Track load time
            const startTime = Date.now();
            await page.goto(url, {
                waitUntil: 'networkidle2',
                timeout: 30000
            });
            const loadTime = Date.now() - startTime;
            // Get page title
            const title = await page.title();
            // Get page size (approximate)
            const pageSize = await page.evaluate(()=>{
                return new Blob([
                    document.documentElement.outerHTML
                ]).size / 1024; // KB
            });
            // Detect technologies
            const technologies = await page.evaluate(()=>{
                const techs = [];
                // Check for common frameworks
                if (window.React) techs.push('React');
                if (window.Vue) techs.push('Vue.js');
                if (window.Angular) techs.push('Angular');
                if (window.jQuery) techs.push('jQuery');
                // Check for common libraries
                if (document.querySelector('[data-reactroot]')) techs.push('React');
                if (document.querySelector('[ng-app]')) techs.push('Angular');
                if (document.querySelector('[v-app]')) techs.push('Vue.js');
                // Check for common CSS frameworks
                if (document.querySelector('.bootstrap')) techs.push('Bootstrap');
                if (document.querySelector('.tailwind')) techs.push('Tailwind CSS');
                if (document.querySelector('.foundation')) techs.push('Foundation');
                return techs;
            });
            return {
                title,
                loadTime,
                pageSize: Math.round(pageSize),
                technologies
            };
        } catch (error) {
            console.warn('Metadata capture failed:', error);
            throw error;
        } finally{
            await page.close();
        }
    } finally{
        await browser.close();
    }
}
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/src/utils/ai-analysis.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname, a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
__turbopack_context__.s({
    "analyzeWebsiteWithAI": (()=>analyzeWebsiteWithAI),
    "generateMockAnalysis": (()=>generateMockAnalysis)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/openai/index.mjs [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$client$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__OpenAI__as__default$3e$__ = __turbopack_context__.i("[project]/node_modules/openai/client.mjs [app-route] (ecmascript) <export OpenAI as default>");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$screenshot$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/utils/screenshot.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/puppeteer-core [external] (puppeteer-core, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@sparticuz/chromium-min/build/esm/index.js [app-route] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$screenshot$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__,
    __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__
]);
([__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$screenshot$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__, __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__);
;
;
;
;
// Global issue counter for unique issue IDs
let issueCounter = 0;
// Initialize Azure OpenAI client only if environment variables are available
let openai = null;
if (process.env.AZURE_OPENAI_API_KEY && process.env.AZURE_OPENAI_ENDPOINT && process.env.AZURE_OPENAI_DEPLOYMENT_NAME) {
    openai = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$openai$2f$client$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__OpenAI__as__default$3e$__["default"]({
        apiKey: process.env.AZURE_OPENAI_API_KEY,
        baseURL: `${process.env.AZURE_OPENAI_ENDPOINT}/openai/deployments/${process.env.AZURE_OPENAI_DEPLOYMENT_NAME}`,
        defaultQuery: {
            'api-version': process.env.AZURE_OPENAI_API_VERSION || '2024-02-15-preview'
        },
        defaultHeaders: {
            'api-key': process.env.AZURE_OPENAI_API_KEY
        }
    });
}
// Helper function to capture website content
async function captureWebsiteContent(url) {
    console.log('ðŸ”§ Launching Puppeteer browser with @sparticuz/chromium-min...');
    const browser = await __TURBOPACK__imported__module__$5b$externals$5d2f$puppeteer$2d$core__$5b$external$5d$__$28$puppeteer$2d$core$2c$__esm_import$29$__["default"].launch({
        args: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].args,
        executablePath: await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$sparticuz$2f$chromium$2d$min$2f$build$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].executablePath(),
        headless: true
    });
    console.log('âœ… Browser launched successfully');
    try {
        const page = await browser.newPage();
        await page.setViewport({
            width: 1920,
            height: 1080
        });
        await page.setUserAgent('Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36');
        page.setDefaultTimeout(30000);
        console.log(`ðŸŒ Navigating to: ${url}`);
        const response = await page.goto(url, {
            waitUntil: 'networkidle0',
            timeout: 30000
        });
        if (!response || !response.ok()) {
            throw new Error(`Failed to load page: ${response?.status()} ${response?.statusText()}`);
        }
        console.log('âœ… Page loaded successfully');
        await new Promise((resolve)=>setTimeout(resolve, 2000));
        // Get the full HTML
        const html = await page.content();
        // Get visible text content
        const visibleText = await page.evaluate(()=>{
            // Remove script and style elements
            const scripts = document.querySelectorAll('script, style, noscript, iframe, svg, img');
            scripts.forEach((el)=>el.remove());
            // Get all text content
            const textContent = document.body.innerText || document.body.textContent || '';
            // Clean up the text
            return textContent.replace(/\s+/g, ' ') // Replace multiple whitespace with single space
            .replace(/\n\s*\n/g, '\n') // Replace multiple newlines with single newline
            .trim();
        });
        // Get page metadata
        const metadata = await page.evaluate(()=>{
            return {
                title: document.title,
                description: document.querySelector('meta[name="description"]')?.getAttribute('content') || '',
                keywords: document.querySelector('meta[name="keywords"]')?.getAttribute('content') || '',
                viewport: document.querySelector('meta[name="viewport"]')?.getAttribute('content') || '',
                robots: document.querySelector('meta[name="robots"]')?.getAttribute('content') || '',
                ogTitle: document.querySelector('meta[property="og:title"]')?.getAttribute('content') || '',
                ogDescription: document.querySelector('meta[property="og:description"]')?.getAttribute('content') || '',
                ogImage: document.querySelector('meta[property="og:image"]')?.getAttribute('content') || '',
                canonical: document.querySelector('link[rel="canonical"]')?.getAttribute('href') || '',
                language: document.documentElement.lang || 'en',
                charset: document.characterSet || 'UTF-8'
            };
        });
        // Get accessibility information
        const accessibility = await page.evaluate(()=>{
            const images = document.querySelectorAll('img');
            const links = document.querySelectorAll('a');
            const buttons = document.querySelectorAll('button, input[type="button"], input[type="submit"]');
            const forms = document.querySelectorAll('form');
            const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
            const inputs = document.querySelectorAll('input, textarea, select');
            const tables = document.querySelectorAll('table');
            const lists = document.querySelectorAll('ul, ol');
            return {
                imagesWithoutAlt: Array.from(images).filter((img)=>!img.alt).length,
                totalImages: images.length,
                imageDetails: Array.from(images).map((img)=>({
                        src: img.src,
                        alt: img.alt,
                        title: img.title,
                        hasAlt: !!img.alt
                    })),
                linksWithoutText: Array.from(links).filter((link)=>!(link.textContent || '').trim()).length,
                totalLinks: links.length,
                linkDetails: Array.from(links).map((link)=>({
                        href: link.href,
                        text: (link.textContent || '').trim(),
                        hasText: !!(link.textContent || '').trim()
                    })),
                buttonsWithoutText: Array.from(buttons).filter((btn)=>!(btn.textContent || '').trim() && !btn.getAttribute('aria-label')).length,
                totalButtons: buttons.length,
                buttonDetails: Array.from(buttons).map((btn)=>({
                        text: (btn.textContent || '').trim(),
                        ariaLabel: btn.getAttribute('aria-label'),
                        type: btn.getAttribute('type'),
                        hasText: !!(btn.textContent || '').trim() || !!btn.getAttribute('aria-label')
                    })),
                formsWithoutLabels: Array.from(forms).filter((form)=>!form.querySelector('label')).length,
                totalForms: forms.length,
                inputDetails: Array.from(inputs).map((input)=>({
                        type: input.getAttribute('type'),
                        name: input.getAttribute('name'),
                        id: input.getAttribute('id'),
                        hasLabel: !!document.querySelector(`label[for="${input.getAttribute('id')}"]`) || !!input.closest('label')
                    })),
                headingStructure: Array.from(headings).map((h)=>({
                        level: h.tagName.toLowerCase(),
                        text: (h.textContent || '').trim()
                    })),
                totalTables: tables.length,
                totalLists: lists.length
            };
        });
        // Get performance metrics
        const performance = await page.evaluate(()=>{
            const perf = performance;
            const navigation = perf.getEntriesByType('navigation')[0];
            return {
                loadTime: navigation ? navigation.loadEventEnd - navigation.loadEventStart : 0,
                domContentLoaded: navigation ? navigation.domContentLoadedEventEnd - navigation.domContentLoadedEventStart : 0,
                firstPaint: perf.getEntriesByType('paint').find((entry)=>entry.name === 'first-paint')?.startTime || 0,
                firstContentfulPaint: perf.getEntriesByType('paint').find((entry)=>entry.name === 'first-contentful-paint')?.startTime || 0
            };
        });
        // Get viewport information
        const viewport = await page.evaluate(()=>{
            return {
                width: window.innerWidth,
                height: window.innerHeight,
                devicePixelRatio: window.devicePixelRatio,
                scrollWidth: document.documentElement.scrollWidth,
                scrollHeight: document.documentElement.scrollHeight
            };
        });
        return {
            html: html.substring(0, 200000),
            visibleText: visibleText.substring(0, 50000),
            metadata,
            accessibility,
            performance,
            viewport
        };
    } finally{
        await browser.close();
    }
}
async function analyzeWebsiteWithAI(url) {
    // Validate Azure OpenAI configuration
    if (!process.env.AZURE_OPENAI_API_KEY) {
        throw new Error('Azure OpenAI API key is not configured');
    }
    if (!process.env.AZURE_OPENAI_ENDPOINT) {
        throw new Error('Azure OpenAI endpoint is not configured');
    }
    if (!process.env.AZURE_OPENAI_DEPLOYMENT_NAME) {
        throw new Error('Azure OpenAI deployment name is not configured');
    }
    console.log('ðŸ”§ Azure OpenAI configuration validated');
    console.log('ðŸ”§ Endpoint:', process.env.AZURE_OPENAI_ENDPOINT);
    console.log('ðŸ”§ Deployment:', process.env.AZURE_OPENAI_DEPLOYMENT_NAME);
    // Reset issue counter for this analysis
    issueCounter = 0;
    // Capture website content and screenshots
    let websiteContent = null;
    let screenshots = {
        desktop: undefined,
        mobile: undefined
    };
    try {
        console.log('ðŸ“„ Capturing website content...');
        console.log('ðŸ”§ Using puppeteer-core with @sparticuz/chromium');
        websiteContent = await captureWebsiteContent(url);
        console.log('âœ… Website content captured successfully');
        // Also capture screenshots for the UI
        const screenshotResult = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$screenshot$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["captureWebsiteScreenshot"])(url).catch((error)=>{
            console.warn('Screenshot capture failed:', error.message);
            return {
                desktop: undefined,
                mobile: undefined
            };
        });
        screenshots = screenshotResult;
    } catch (error) {
        console.error('âŒ Failed to capture website content:', error);
        throw new Error(`Failed to access website: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
    const systemPrompt = `You are an expert UX/UI analyst and web accessibility specialist. Your task is to analyze websites and provide comprehensive, specific, and actionable feedback.

IMPORTANT: Be extremely specific and detailed in your analysis, but ONLY based on the data provided. Do NOT make up specific measurements, colors, or visual details you cannot verify from the provided content.

Instead of generic statements like "Low contrast in some areas", provide specific details like:
- "Missing alt text on images (found 5 images without alt attributes)"
- "Navigation menu has 3 links without descriptive text"
- "Contact form is missing proper labels for input fields"
- "Page has poor heading structure with missing H1 and H2 elements"

For visual issues like contrast, colors, or spacing, only mention them if you can see them explicitly in the HTML/CSS data provided. Otherwise, focus on structural, semantic, and content-based issues.

Analyze the provided website content and return a detailed analysis in the following JSON format:

{
  "score": number (0-100),
  "strengths": ["specific strength with details"],
  "improvements": ["specific improvement with context"],
  "recommendations": ["actionable recommendation with reasoning"],
  "details": {
    "accessibility": {
      "score": number (0-100),
      "issues": [
        {
          "id": "unique-identifier",
          "title": "Specific issue title",
          "description": "Detailed description of the issue with specific elements, colors, measurements, etc.",
          "severity": "low|medium|high|critical",
          "category": "accessibility",
          "location": {
            "element": "specific element name (e.g., 'navigation menu', 'contact form')",
            "selector": "CSS selector if applicable",
            "page": "page name or URL path"
          },
          "impact": "How this affects users (e.g., 'Screen reader users cannot understand the purpose of this image')",
          "recommendation": "Specific actionable solution with code examples if applicable",
          "codeExample": "Code snippet showing the fix"
        }
      ]
    },
    "performance": {
      "score": number (0-100),
      "issues": [/* same structure as above */]
    },
    "usability": {
      "score": number (0-100),
      "issues": [/* same structure as above */]
    },
    "design": {
      "score": number (0-100),
      "issues": [/* same structure as above */]
    }
  },
  "metadata": {
    "pageTitle": "Page title",
    "loadTime": estimated_load_time_in_ms,
    "pageSize": estimated_page_size_in_kb,
    "technologies": ["detected technologies"]
  }
}

Guidelines for analysis:
- Accessibility: Check alt text presence, ARIA labels, heading structure, form labels, link descriptions, semantic HTML usage
- Performance: Evaluate based on provided metrics (load times, paint times), code structure, resource optimization opportunities
- Usability: Assess navigation structure, content organization, form usability, mobile responsiveness indicators, user flow
- Design: Review HTML structure for visual hierarchy, semantic markup, content organization, and layout patterns

IMPORTANT: Focus on issues you can actually identify from the provided data. Do not make assumptions about visual appearance, colors, or specific measurements unless they are explicitly mentioned in the HTML/CSS content.

For each issue:
1. Be specific about which element has the problem (based on the HTML structure provided)
2. Provide exact counts, element types, or structural details when possible
3. Explain the impact on users
4. Give actionable recommendations with code examples
5. Assign appropriate severity based on user impact

Remember: Only provide feedback on issues you can actually identify from the provided data. Do not make up visual details, colors, or measurements that aren't explicitly present in the HTML/CSS content.

IMPORTANT: If you cannot analyze the website for any reason (content policy, accessibility, etc.), respond with a JSON object explaining why:
{
  "error": "reason_for_failure",
  "message": "Detailed explanation of why analysis failed"
}`;
    const userPrompt = `Please analyze the following website content for: ${url}

WEBSITE CONTENT:
Title: ${websiteContent.metadata.title}
Description: ${websiteContent.metadata.description}
Language: ${websiteContent.metadata.language}

VISIBLE TEXT CONTENT (first 25000 characters):
${websiteContent.visibleText.substring(0, 25000)}

ACCESSIBILITY DATA:
- Images without alt text: ${websiteContent.accessibility.imagesWithoutAlt}/${websiteContent.accessibility.totalImages}
- Links without text: ${websiteContent.accessibility.linksWithoutText}/${websiteContent.accessibility.totalLinks}
- Buttons without text: ${websiteContent.accessibility.buttonsWithoutText}/${websiteContent.accessibility.totalButtons}
- Forms without labels: ${websiteContent.accessibility.formsWithoutLabels}/${websiteContent.accessibility.totalForms}
- Total tables: ${websiteContent.accessibility.totalTables}
- Total lists: ${websiteContent.accessibility.totalLists}
- Heading structure: ${websiteContent.accessibility.headingStructure.map((h)=>`${h.level}: ${h.text.substring(0, 50)}`).join(', ')}

DETAILED ACCESSIBILITY ANALYSIS:
- Images needing alt text: ${websiteContent.accessibility.imageDetails.filter((img)=>!img.hasAlt).map((img)=>img.src.split('/').pop()).join(', ')}
- Links needing text: ${websiteContent.accessibility.linkDetails.filter((link)=>!link.hasText).map((link)=>link.href).join(', ')}
- Buttons needing text: ${websiteContent.accessibility.buttonDetails.filter((btn)=>!btn.hasText).map((btn)=>btn.type || 'button').join(', ')}
- Inputs without labels: ${websiteContent.accessibility.inputDetails.filter((input)=>!input.hasLabel).map((input)=>`${input.type} (${input.name || input.id || 'unnamed'})`).join(', ')}

PERFORMANCE DATA:
- Load time: ${websiteContent.performance.loadTime}ms
- DOM content loaded: ${websiteContent.performance.domContentLoaded}ms
- First paint: ${websiteContent.performance.firstPaint}ms
- First contentful paint: ${websiteContent.performance.firstContentfulPaint}ms

VIEWPORT DATA:
- Width: ${websiteContent.viewport.width}px
- Height: ${websiteContent.viewport.height}px
- Scroll width: ${websiteContent.viewport.scrollWidth}px
- Scroll height: ${websiteContent.viewport.scrollHeight}px

HTML STRUCTURE (first 50000 characters):
${websiteContent.html.substring(0, 50000)}

Provide a comprehensive UX analysis focusing on accessibility, performance, usability, and design. Consider both desktop and mobile experiences.

IMPORTANT: Be extremely specific in your feedback. Instead of saying "some areas have low contrast", identify exactly which elements, what the colors are, and what the contrast ratio is.`;
    try {
        if (!openai) {
            throw new Error('Azure OpenAI client is not initialized - missing environment variables');
        }
        console.log('ðŸ¤– Sending request to Azure OpenAI...');
        console.log('Model:', process.env.AZURE_OPENAI_DEPLOYMENT_NAME || 'gpt-4o');
        console.log('URL being analyzed:', url);
        const completion = await openai.chat.completions.create({
            model: process.env.AZURE_OPENAI_DEPLOYMENT_NAME || 'gpt-4o',
            messages: [
                {
                    role: 'system',
                    content: systemPrompt
                },
                {
                    role: 'user',
                    content: userPrompt
                }
            ],
            temperature: 0.2,
            max_tokens: 8000
        });
        console.log('âœ… Received response from Azure OpenAI');
        const responseContent = completion.choices[0]?.message?.content;
        if (!responseContent) {
            console.error('âŒ No response content from AI model');
            throw new Error('No response from AI model');
        }
        console.log('ðŸ“ Response length:', responseContent.length);
        console.log('ðŸ“ Response preview:', responseContent.substring(0, 200) + '...');
        // Try to parse the JSON response
        let analysisData;
        try {
            console.log('ðŸ” Attempting to parse JSON response...');
            // Extract JSON from the response (in case there's additional text)
            const jsonMatch = responseContent.match(/\{[\s\S]*\}/);
            if (jsonMatch) {
                console.log('ðŸ“‹ Found JSON match, parsing...');
                analysisData = JSON.parse(jsonMatch[0]);
            } else {
                console.log('ðŸ“‹ No JSON match found, trying to parse entire response...');
                analysisData = JSON.parse(responseContent);
            }
            console.log('âœ… JSON parsing successful');
            // Check if the AI returned an error response
            if (analysisData.error) {
                console.error('âŒ AI returned error response:', analysisData.error);
                throw new Error(`AI cannot analyze this website: ${analysisData.message || analysisData.error}`);
            }
        } catch (error) {
            console.error('âŒ Failed to parse AI response:', error);
            console.error('ðŸ“ Raw response:', responseContent);
            // Check if the AI is rejecting the request
            if (responseContent.toLowerCase().includes('unfortunately') || responseContent.toLowerCase().includes('cannot') || responseContent.toLowerCase().includes('unable') || responseContent.toLowerCase().includes('sorry')) {
                throw new Error(`AI cannot analyze this website: ${responseContent.substring(0, 100)}...`);
            }
            throw new Error(`Invalid AI response format: ${error instanceof Error ? error.message : 'Unknown parsing error'}`);
        }
        // Validate and structure the response
        const analysis = {
            url,
            score: Math.min(100, Math.max(0, analysisData.score || 70)),
            strengths: analysisData.strengths || [],
            improvements: analysisData.improvements || [],
            recommendations: analysisData.recommendations || [],
            screenshots,
            timestamp: new Date().toISOString(),
            details: {
                accessibility: {
                    score: Math.min(100, Math.max(0, analysisData.details?.accessibility?.score || 70)),
                    issues: validateIssues(analysisData.details?.accessibility?.issues || [], 'accessibility')
                },
                performance: {
                    score: Math.min(100, Math.max(0, analysisData.details?.performance?.score || 70)),
                    issues: validateIssues(analysisData.details?.performance?.issues || [], 'performance')
                },
                usability: {
                    score: Math.min(100, Math.max(0, analysisData.details?.usability?.score || 70)),
                    issues: validateIssues(analysisData.details?.usability?.issues || [], 'usability')
                },
                design: {
                    score: Math.min(100, Math.max(0, analysisData.details?.design?.score || 70)),
                    issues: validateIssues(analysisData.details?.design?.issues || [], 'design')
                }
            },
            metadata: {
                pageTitle: analysisData.metadata?.pageTitle || websiteContent.metadata.title,
                loadTime: analysisData.metadata?.loadTime || websiteContent.performance.loadTime,
                pageSize: analysisData.metadata?.pageSize || Math.round(websiteContent.html.length / 1024),
                technologies: analysisData.metadata?.technologies || []
            }
        };
        console.log('âœ… AI analysis completed successfully');
        return analysis;
    } catch (error) {
        console.error('âŒ Enhanced AI analysis failed:', error);
        console.error('Stack trace:', {
            message: error instanceof Error ? error.message : 'Unknown error',
            stack: error instanceof Error ? error.stack : undefined
        });
        throw new Error(`AI analysis failed: ${error instanceof Error ? error.message : 'Unknown error'}`);
    }
}
function validateIssues(issues, category) {
    return issues.map((issue)=>{
        issueCounter++;
        return {
            id: issue.id || `issue-${issueCounter}`,
            title: issue.title || 'Unspecified Issue',
            description: issue.description || 'No description provided',
            severity: [
                'low',
                'medium',
                'high',
                'critical'
            ].includes(issue.severity) ? issue.severity : 'medium',
            category: category,
            location: issue.location || {},
            impact: issue.impact || 'Impact not specified',
            recommendation: issue.recommendation || 'No recommendation provided',
            codeExample: issue.codeExample || undefined
        };
    });
}
function generateMockAnalysis(url, fallbackReason) {
    return {
        url,
        score: Math.floor(Math.random() * 40) + 60,
        timestamp: new Date().toISOString(),
        fallbackReason: fallbackReason || undefined,
        strengths: [
            "Clean and modern design aesthetic",
            "Good use of white space and typography",
            "Responsive design works well on mobile devices",
            "Clear navigation structure",
            "Fast loading times"
        ],
        improvements: [
            "Call-to-action buttons could be more prominent",
            "Color contrast could be improved for better accessibility",
            "Some pages lack clear user guidance",
            "Contact information could be more accessible",
            "Loading states could provide better user feedback"
        ],
        recommendations: [
            "Implement A/B testing for key conversion elements",
            "Add more interactive elements to increase engagement",
            "Consider adding a chatbot for immediate user support",
            "Optimize images for faster loading",
            "Add breadcrumb navigation for better user orientation"
        ],
        details: {
            accessibility: {
                score: Math.floor(Math.random() * 30) + 70,
                issues: [
                    {
                        id: "accessibility-contrast-1",
                        title: "Low contrast text in navigation menu",
                        description: "White text (#FFFFFF) on light gray background (#F0F0F0) has insufficient contrast ratio of 2.1:1",
                        severity: "high",
                        category: "accessibility",
                        location: {
                            element: "navigation menu",
                            page: "homepage"
                        },
                        impact: "Users with visual impairments cannot read the navigation text",
                        recommendation: "Change background color to darker gray (#666666) for 4.5:1 contrast ratio"
                    },
                    {
                        id: "accessibility-alt-1",
                        title: "Missing alt text on hero image",
                        description: "Hero banner image 'hero-banner.jpg' lacks descriptive alt text",
                        severity: "medium",
                        category: "accessibility",
                        location: {
                            element: "hero image",
                            page: "homepage"
                        },
                        impact: "Screen reader users cannot understand the image content",
                        recommendation: "Add descriptive alt text: 'alt=\"Company team working together in modern office\"'"
                    }
                ]
            },
            performance: {
                score: Math.floor(Math.random() * 25) + 75,
                issues: [
                    {
                        id: "performance-images-1",
                        title: "Large unoptimized hero image",
                        description: "Hero image 'hero-banner.jpg' is 2.3MB and not optimized for web",
                        severity: "medium",
                        category: "performance",
                        location: {
                            element: "hero image",
                            page: "homepage"
                        },
                        impact: "Slow page load times, especially on mobile devices",
                        recommendation: "Compress image to under 200KB and use WebP format"
                    },
                    {
                        id: "performance-css-1",
                        title: "Unoptimized CSS delivery",
                        description: "CSS is loaded synchronously and blocks rendering",
                        severity: "low",
                        category: "performance",
                        location: {
                            element: "stylesheet",
                            page: "all"
                        },
                        impact: "Delays visual rendering of the page",
                        recommendation: "Use critical CSS inlining and async loading for non-critical styles"
                    }
                ]
            },
            usability: {
                score: Math.floor(Math.random() * 35) + 65,
                issues: [
                    {
                        id: "usability-nav-1",
                        title: "Complex navigation structure",
                        description: "Navigation has 3 levels deep with unclear hierarchy",
                        severity: "medium",
                        category: "usability",
                        location: {
                            element: "main navigation",
                            page: "all"
                        },
                        impact: "Users struggle to find desired content quickly",
                        recommendation: "Simplify to 2 levels maximum and add breadcrumbs"
                    },
                    {
                        id: "usability-flow-1",
                        title: "Unclear user flow on homepage",
                        description: "No clear call-to-action or next steps for visitors",
                        severity: "high",
                        category: "usability",
                        location: {
                            element: "homepage content",
                            page: "homepage"
                        },
                        impact: "High bounce rate as users don't know what to do next",
                        recommendation: "Add prominent CTA button and clear value proposition"
                    }
                ]
            },
            design: {
                score: Math.floor(Math.random() * 20) + 80,
                issues: [
                    {
                        id: "design-spacing-1",
                        title: "Inconsistent spacing between sections",
                        description: "Sections have varying margins (20px, 40px, 30px) instead of consistent spacing",
                        severity: "low",
                        category: "design",
                        location: {
                            element: "page sections",
                            page: "all"
                        },
                        impact: "Visual inconsistency creates poor user experience",
                        recommendation: "Use consistent 32px spacing between all sections"
                    },
                    {
                        id: "design-mobile-1",
                        title: "Poor mobile layout for contact form",
                        description: "Contact form fields are too small (height: 32px) on mobile devices",
                        severity: "medium",
                        category: "design",
                        location: {
                            element: "contact form",
                            page: "contact"
                        },
                        impact: "Difficult to tap and interact with form elements",
                        recommendation: "Increase form field height to 44px minimum for mobile"
                    }
                ]
            }
        },
        metadata: {
            pageTitle: "Sample Website",
            loadTime: 2500,
            pageSize: 1200,
            technologies: [
                "React",
                "Next.js",
                "Tailwind CSS"
            ]
        }
    };
}
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/src/app/api/analyze-website/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname, a: __turbopack_async_module__ } = __turbopack_context__;
__turbopack_async_module__(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {
__turbopack_context__.s({
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$ai$2d$analysis$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/utils/ai-analysis.ts [app-route] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$ai$2d$analysis$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__
]);
([__TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$ai$2d$analysis$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__);
;
;
async function POST(request) {
    try {
        const { url } = await request.json();
        if (!url) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'URL is required'
            }, {
                status: 400
            });
        }
        // Validate URL format
        const urlPattern = /^https?:\/\/.+/;
        if (!urlPattern.test(url)) {
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                error: 'Invalid URL format. Please provide a URL starting with http:// or https://'
            }, {
                status: 400
            });
        }
        let analysis;
        // Check if Azure OpenAI is configured
        if (process.env.AZURE_OPENAI_API_KEY && process.env.AZURE_OPENAI_ENDPOINT && process.env.AZURE_OPENAI_DEPLOYMENT_NAME) {
            try {
                console.log('ðŸ” Using enhanced AI analysis...');
                analysis = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$ai$2d$analysis$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["analyzeWebsiteWithAI"])(url);
            } catch (aiError) {
                console.error('âŒ Enhanced AI analysis failed:', aiError);
                // Check if it's a content policy violation or technical failure
                const errorMessage = aiError instanceof Error ? aiError.message : 'Unknown error';
                if (errorMessage.includes('AI cannot analyze this website') || errorMessage.includes('content policy') || errorMessage.includes('cannot process')) {
                    // Content policy violation - return 422
                    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                        error: 'AI analysis failed',
                        message: 'Unable to analyze this website. This could be due to the website being inaccessible, requiring authentication, or having content that the AI cannot process.',
                        url: url,
                        timestamp: new Date().toISOString()
                    }, {
                        status: 422
                    });
                } else {
                    // Technical failure - fall back to basic analysis
                    console.log('âš ï¸ AI failed for technical reasons, falling back to basic analysis...');
                    analysis = (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$ai$2d$analysis$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["generateMockAnalysis"])(url, 'AI failed for technical reasons, here is a basic analysis for demonstration purposes.');
                }
            }
        } else {
            console.log('âš ï¸ Azure OpenAI not configured, using basic analysis...');
            analysis = (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$utils$2f$ai$2d$analysis$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["generateMockAnalysis"])(url);
        }
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json(analysis);
    } catch (error) {
        console.error('âŒ Error analyzing website:', error);
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: 'Failed to analyze website'
        }, {
            status: 500
        });
    }
}
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),

};

//# sourceMappingURL=%5Broot%20of%20the%20server%5D__7c2d41ed._.js.map